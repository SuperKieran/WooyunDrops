<main class="main-container ng-scope" ng-view=""><div class="main receptacle post-view ng-scope"><article class="entry ng-scope" ng-controller="EntryCtrl" ui-lightbox=""><header><h1 class="entry-title ng-binding">[XSS神器]XssEncode chrome插件 - 0x_Jin</h1><div class="entry-meta"><a target="_blank" class="author name ng-binding">0x_Jin</a> <span class="bull">·</span> <time title="2013/11/15 16:44" ui-time="" datetime="2013/11/15 16:44" class="published ng-binding ng-isolate-scope">2013/11/15 16:44</time></div></header><section class="entry-content ng-binding" ng-bind-html="postContentTrustedHtml"><p></p><h2>0x00 闲扯</h2><hr><p>好吧继上一篇文章之后，就没发文章了！(其实是一直在写但是写的很少还凑不起一篇文章而已)</p><p>但是这几天对插件进行了一定的改良了 因为在自己在实际的XSS过程中也发现了自己的插件 还不够强大！</p><p>不能够百分之百的满足自己的需求！所以就根据自己平常的需求给加了上去！</p><p>我想做到玩XSS一个工具即可解决需求！所以感觉即使是现在的插件也还有很大的不足！</p><p>所以很希望得到你们的意见 东凑一块 西凑一块写成一个真正的一个插件解决需求！</p><p>(现在想给hook生成功能块加一个 是否自动把hook转换成短链接！但是。。。在技术上有点问题)</p><p>另外还有什么其他的功能 或者一些比较猥琐的小技巧 希望大家提出来 我加上。。。</p><p>比如在chrome里隐藏payload 。。。我一直在想如何才能构造一段被chrome认为是无效的字符。。并且还能够执行！</p><h2>0x01 界面以及功能介绍</h2><hr><p><strong>兼容性没做所以在不同的分辨率下会乱码。。。这个不会做</strong></p><p><strong>分辨率：1280 X 800  (求教)</strong></p><p><img alt="2013111510540039674.jpg" img-src="bbffce96a6afffe57682d3ef86b41041e087cf0a.jpg"></p><h3>编码</h3><p>请把需要编码的字符放在左边的输入框内 Encode / Decode</p><p>然后点击中间上方的Encode按钮 选择你要编码的类型 然后点击相应的按钮即可！</p><p>经过相应编码后的内容便会在右边的Output框中！</p><h3>新功能介绍</h3><p>进制编码常规变异：</p><p>进制编码包括：</p><pre><code>html编码的十进制编码
html编码的十六进制编码
javascript的十六进制编码
javascript的八进制编码 
</code></pre><h3>进制编码常规变异的功能：</h3><p>会给编码前面的数字多加7个0，因为IE对进制编码加0，只识别到八个0，多了的话就认为这不是个有效的值了！</p><p>也有很多程序过滤规则也是这样写的！他们会把你变异了的值给解析回来，然后再判断是不是危险字符！</p><h3>适用场景：</h3><p>当进制编码被解析回来，再次过滤了的时候，比如 &amp;#60 在过滤程序中被还原回来再次过滤了！</p><p>但是&amp;#0060没有在过滤程序中被还原回来，但是在页面中被浏览器被解析还原了，那么就可以用进制编码的常规变异！</p><h3>进制编码非常规变异：</h3><p>进制编码非常规变异功能：</p><p>会给编码的数字前面多加10个0！原因同上！</p><p>适用场景：</p><p>当进制编码被解析回来，再次过滤了的时候，比如 &amp;#60 或者 &amp;#000000060都被还原回来，再次过滤的话，那么便可以用非常规变异！</p><p>IE识别到8个0 可是chrome能识别到更多的0！很多过滤程序都是根据IE的8个0来写的！所以更多的0 也是一种绕过方式！</p><p>使用心得：以上的功能都是自己亲身经历到的 当时是某GOV的站 在这里贴出payload吧 以及笔记</p><pre><code>search?str=xxxx%3Ca%20href=%22data:text/html;%26%230000000000000000098ase64%26%230000000000000044%20PGltZyBzcmM9eCBvbmVycm9yPWFsZXJ0KDEpPg==%22%3Etest%3C/a%3E 
</code></pre><p>缺陷参数：str</p><p>过滤规则够BT 但是同样能绕！</p><p>会把提交的编码 给解码 然后再插入到网页中！然后再对网页内的值进行检查 过滤！</p><p>base64 --> %26%230000000000000000098ase64</p><p>首先%26%23会被还原成 &amp;#  于是变成了： &amp;#00000000098 于是被还原成：b b插入到页面 再检查 b+ase64  = base64 满足规则  于是又过滤成 ba<x>se64  绕过失败！</x></p><p>但是如果b的html十进制编码 再多加几个000  便不会被他给解码  但是在浏览器中又会被解码 于是便可以这样绕过！</p><h3>html编码去分号：</h3><p>(此选项可配合其他选项一起使用 比如进行html编码时 勾选常规变异 + 去html编码分号)</p><p>ps:小伙伴们勿淘气别选了 常规变异 又勾选非常规变异。。。 那你到底是要闹哪样！</p><p>还有勾选编码时  也勾选了 hook生成的话 那么我不知道你要闹那样。。</p><p>如果要对生成的钩子进行编码的话 那么就弄两次吧 一次：生成 复制 ，二次： 粘贴 编码！</p><h2>使用场景：</h2><p>html实体编码的分号在大部分情况下都是可以去掉的 能减少输入字符！我有强迫症。。</p><p>我一般选择html实体编码的时候 都会必勾选！</p><h2>&amp;#URL编码：</h2><p>这个对我来说真的是经常用到！比如在测试反射型XSS 以及 DOM XSS时！</p><p>因为&amp;#在url中都有特殊的含义 我们很多时候都是把他们当做一个html实体编码表示的方式而已！</p><p>可是浏览器不会这样认为，&amp; 会被认为是参数的分隔符 比如一个url:</p><pre><code>http://xssec.net/?x=1&amp;c=2&amp;d=4 
</code></pre><p>如果我们在url上写&amp;号是会被当成参数分隔符的 进行一下url编码就号了！</p><p>#号呢，就是location.hash获取的值以及什么的 所以这种字符还是url编码的好~</p><p>比如以下这个payload:</p><pre><code>search.php?searchfield=xsser%c0\%22%20onfocus=%26%2397%26%23108%26%23101%26%23114%26%23116%26%2340%26%2347%26%2374%26%23105%26%23110%26%2347%26%2341%20autofocus//&amp;imageField=%CB%D1%CB%F7
</code></pre><p>大家还原下编码就能看到原本的字符了！</p><p>Hook生成</p><p>基本介绍 ：把你的钩子(hook)放入到左边的Encode里 然后勾选你要进行生成的hook类型！然后点后面的生成就好了！</p><p>每次请选择一种，别淘气 我没写太多的判断js。。。 精力有限！</p><p>下面贴几个演示吧：</p><p><img alt="2013111511480349866.jpg" img-src="45b9bdb9ff22e54c412bc6f77c3b8d200eb873ea.jpg"></p><p>在钩子生成方面做的不是特别好，也是自己经验不足的原因 大家有更猥琐的 加载钩子的payload 求pm加上去！</p><p>下载链接：</p><p><a href="http://static.wooyun.org/20141017/2014101711311922017.zip">xss-encode_20131115121612.crx_.zip</a></p><p>联系方式：</p><p>mail:<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="ef9d80809baf979c9c8a8cc1818a9b">[email&#160;protected]</a></p><p>http://t.qq.com/Ox_Jin</p><p></p></section></article><div class="entry-controls clearfix"><div style="float:left;color:#9d9e9f;font-size:15px"><span>&copy;乌云知识库版权所有 未经许可 禁止转载</span></div></div><div class="yarpp-related"><h3>为您推荐了适合您的技术文章:</h3><ol id="recommandsystem"><li><a href="http://drops.wooyun.org/tips/2469" rel="bookmark" id="re1">Shodan搜索引擎介绍</a></li><li><a href="http://drops.wooyun.org/tips/689" rel="bookmark" id="re2">XSS与字符编码的那些事儿 ---科普文</a></li><li><a href="http://drops.wooyun.org/tools/3786" rel="bookmark" id="re3">说说RCE那些事儿</a></li><li><a href="http://drops.wooyun.org/tools/5751" rel="bookmark" id="re4">burpsuite扩展开发之Python</a></li></ol></div><div id="comments" class="comment-list clearfix"><div id="comment-list"><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">J.R</span> <span class="reply-time">2014-06-30 00:10:21</span></div><p></p><p>为什么添加不了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">不期而遇</span> <span class="reply-time">2014-01-26 11:30:20</span></div><p></p><p>import</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">核攻击</span> <span class="reply-time">2013-11-24 14:54:01</span></div><p></p><p>mark...</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">大隐</span> <span class="reply-time">2013-11-20 09:41:04</span></div><p></p><p>怎么送乌云币哥送你一个</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">大隐</span> <span class="reply-time">2013-11-20 09:40:19</span></div><p></p><p>你终于发出来了 急死我了</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-19 14:47:12</span></div><p></p><p>然后再发现我们是失踪多年的兄妹么 我是哥哥。。。 嗯</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">3xpl0it</span> <span class="reply-time">2013-11-19 14:13:51</span></div><p></p><p>要不你试试，说不定我的qq密码跟你的都一样。电影都是这么狗血的剧情。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-19 14:04:45</span></div><p></p><p>.... 你还能再狗血点么。。。。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">3xpl0it</span> <span class="reply-time">2013-11-19 14:02:06</span></div><p></p><p>于万千人中，不偏不巧，刚好遇到了你，这就是缘分。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-19 09:34:17</span></div><p></p><p>只有前端基础就可以玩得很顺溜 还能影响整个网站用户 没有理由不让人喜欢～</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-19 09:33:42</span></div><p></p><p>你头像跟我百度的头像一摸一样 这是巧合 还是故意的？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">小胖子</span> <span class="reply-time">2013-11-19 09:13:57</span></div><p></p><p>为什么XSS会这么火?</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">3xpl0it</span> <span class="reply-time">2013-11-19 08:45:24</span></div><p></p><p>一直在用，很不错。3q</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-18 08:45:23</span></div><p></p><p>- - 发chrome商店 貌似有点麻烦 还要收费的样子！现在只是在追求功能还没做兼容性。。 等哪天它成熟了 应该会出现在商店</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">冷静</span> <span class="reply-time">2013-11-17 21:31:49</span></div><p></p><p>那个貌似9美刀</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">囧思九千</span> <span class="reply-time">2013-11-17 20:45:24</span></div><p></p><p>赞一个，怎么没有发在chrome商店呢？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-16 00:07:46</span></div><p></p><p>安装后 是在控制台运行的 按下F12你会发现你的控制台多出来了个 XSS encode</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-16 00:07:12</span></div><p></p><p>短短 你要不要这么逗</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">nmeia</span> <span class="reply-time">2013-11-15 23:48:09</span></div><p></p><p>安装后怎么打开呢？</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">Sogili</span> <span class="reply-time">2013-11-15 23:12:37</span></div><p></p><p>我来膜拜楼主了。</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x0F</span> <span class="reply-time">2013-11-15 22:52:49</span></div><p></p><p>JsBoxing!</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">big、face</span> <span class="reply-time">2013-11-15 19:55:43</span></div><p></p><p>顶大牛.. 一直在使用大牛开发的插件..</p><p></p></div></div><div class="note-comment"><img class="avatar" alt="30" src="http://wooyun.b0.upaiyun.com/wooyun_job/avatar/default.png"><div class="content"><div class="comment-header"><span class="author-link">0x_Jin</span> <span class="reply-time">2013-11-15 17:07:17</span></div><p></p><p>好吧 一楼自己坐！<br>大家有什么比较好的功能 可以加上的话 希望PM我<br>功能慢慢的往上加！<br><a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="11637e7e655169626274723f7f7465">[email&#160;protected]</a></p><p></p></div></div></div></div></div></main>